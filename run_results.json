{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.8", "generated_at": "2024-11-10T17:49:31.615699Z", "invocation_id": "831fdcd3-6c6a-4d65-9bb1-a549c9de2db8", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-10T17:49:30.995392Z", "completed_at": "2024-11-10T17:49:31.061138Z"}, {"name": "execute", "started_at": "2024-11-10T17:49:31.062885Z", "completed_at": "2024-11-10T17:49:31.062904Z"}], "thread_id": "Thread-1", "execution_time": 0.07311701774597168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.lumley_analytics.base_chatt_police_police_incidents", "compiled": true, "compiled_code": "with source as (\n      select * from `lumley-analytics`.`chatt_police`.`police_incidents`\n),\nrenamed as (\n    select\n\n        `address`,\n        `city`,\n        `state`,\n        `zip`,\n        `date_incident`,\n        `jurisdiction`,\n        `incident_tract`,\n        `zone`,\n        `ucr_incident_code`,\n        `incident_description`,\n        `incident_type`,\n        `case_number`,\n        `case_status`,\n        `case_status_description`,\n        `latitude`,\n        `longitude`,\n        `citydst`,\n        `neighborhood`\n\n    from source\n\n        qualify row_number() over (partition by\n        address,\n        city,\n        state,\n        zip,\n        date_incident,\n        jurisdiction,\n        incident_tract,\n        zone,\n        ucr_incident_code,\n        incident_description,\n        incident_type,\n        case_number,\n        case_status,\n        case_status_description,\n        latitude,\n        longitude,\n        citydst,\n        neighborhood\n\n        order by\n\n        etl_load_time desc\n        \n        ) = 1\n)\nselect * from renamed", "relation_name": "`lumley-analytics`.`dbt_dev`.`base_chatt_police_police_incidents`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-10T17:49:31.021371Z", "completed_at": "2024-11-10T17:49:31.062110Z"}, {"name": "execute", "started_at": "2024-11-10T17:49:31.064030Z", "completed_at": "2024-11-10T17:49:31.064040Z"}], "thread_id": "Thread-3", "execution_time": 0.07216048240661621, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.lumley_analytics.source_accepted_values_chatt_311_service_requests_src_chattadata_311_service_requests_ispublic__yes__no.f2758ed1c7", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        ispublic as value_field,\n        count(*) as n_records\n\n    from `lumley-analytics`.`chatt_311_service_requests`.`src_chattadata_311_service_requests`\n    group by ispublic\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'yes','no'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-10T17:49:31.027812Z", "completed_at": "2024-11-10T17:49:31.064930Z"}, {"name": "execute", "started_at": "2024-11-10T17:49:31.066609Z", "completed_at": "2024-11-10T17:49:31.066616Z"}], "thread_id": "Thread-4", "execution_time": 0.07322573661804199, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.lumley_analytics.source_accepted_values_chatt_311_service_requests_src_chattadata_311_service_requests_on_time_indicator__Yes__No__N_A.f8064ac16a", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        on_time_indicator as value_field,\n        count(*) as n_records\n\n    from `lumley-analytics`.`chatt_311_service_requests`.`src_chattadata_311_service_requests`\n    group by on_time_indicator\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Yes','No','N/A'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-10T17:49:31.070935Z", "completed_at": "2024-11-10T17:49:31.080465Z"}, {"name": "execute", "started_at": "2024-11-10T17:49:31.081675Z", "completed_at": "2024-11-10T17:49:31.081685Z"}], "thread_id": "Thread-1", "execution_time": 0.013541936874389648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.lumley_analytics.fct_chatt_police_police_incidents_dashboard", "compiled": true, "compiled_code": "with source as (\n\n    select\n\n        address,\n        case_number,\n        date_incident,\n        incident_description,\n        latitude,\n        longitude,\n        zip\n\n    from\n\n        `lumley-analytics`.`dbt_dev`.`base_chatt_police_police_incidents`\n\n)\n\nselect * from source", "relation_name": "`lumley-analytics`.`dbt_dev`.`fct_chatt_police_police_incidents_dashboard`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-10T17:49:31.074649Z", "completed_at": "2024-11-10T17:49:31.081067Z"}, {"name": "execute", "started_at": "2024-11-10T17:49:31.082597Z", "completed_at": "2024-11-10T17:49:31.082606Z"}], "thread_id": "Thread-3", "execution_time": 0.013647794723510742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.lumley_analytics.dbt_utils_unique_combination_of_columns_base_chatt_police_police_incidents_case_number__incident_description__latitude__longitude__ucr_incident_code.db530c7cbb", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        case_number, incident_description, latitude, longitude, ucr_incident_code\n    from `lumley-analytics`.`dbt_dev`.`base_chatt_police_police_incidents`\n    group by case_number, incident_description, latitude, longitude, ucr_incident_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-10T17:49:31.010591Z", "completed_at": "2024-11-10T17:49:31.275408Z"}, {"name": "execute", "started_at": "2024-11-10T17:49:31.276050Z", "completed_at": "2024-11-10T17:49:31.276062Z"}], "thread_id": "Thread-2", "execution_time": 0.28490114212036133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.lumley_analytics.base_src_chattadata_311_service_requests", "compiled": true, "compiled_code": "-- The first CTE (source) selects all columns from the source table 'src_chattadata_311_service_requests'\n-- using the dbt_utils.star macro to include all columns dynamically.\nwith source as (\n    select\n        distinct\n        `service_request_key`,\n  `created_date`,\n  `due_at`,\n  `completed_at`,\n  `on_time_indicator`,\n  `department`,\n  `request_type`,\n  `description`,\n  `request_type_code`,\n  `status_code`,\n  `intake_form`,\n  `actual_days_to_complete_working`,\n  `sla_fy_2019`,\n  `ispublic`,\n  `citydst`,\n  `publiclocation`,\n  `transmit_timestamp`\n    from\n        `lumley-analytics`.`chatt_311_service_requests`.`src_chattadata_311_service_requests`\n),\n\n-- The second CTE (cast_columns) converts specific columns to their intended data types.\n-- All columns, except for 'transmit_timestamp', are initially strings and need to be cast.\ncast_columns as (\n    select\n        service_request_key,                                                 -- Keep service_request_key as is (string)\n        cast(created_date as datetime) as created_date,                      -- Convert created_date to datetime\n        cast(due_at as datetime) as due_at,                                  -- Convert due_at to datetime\n        cast(completed_at as datetime) as completed_at,                      -- Convert completed_at to datetime\n        on_time_indicator,                                                   -- Keep on_time_indicator as is (string)\n        department,                                                          -- Keep department as is (string)\n        request_type,                                                        -- Keep request_type as is (string)\n        description,                                                         -- Keep description as is (string)\n        request_type_code,                                                   -- Keep request_type_code as is (string)\n        status_code,                                                         -- Keep status_code as is (string)\n        intake_form,                                                         -- Keep intake_form as is (string)\n        cast(actual_days_to_complete_working as int64) as actual_days_to_complete_working,  -- Convert to integer\n        cast(sla_fy_2019 as int64) as sla_fy_2019,                           -- Convert to integer\n        ispublic,                                                            -- Keep ispublic as is (string)\n        cast(citydst as int64) as citydst,                                   -- Convert citydst to integer\n        publiclocation,                                                      -- Keep publiclocation as is (string). Convert to GEOGRAPHY in staging.\n        transmit_timestamp                                                   -- Keep transmit_timestamp as is (timestamp)\n    from\n        source\n),\n\n-- The final CTE (final_cte) selects and organizes all columns for the final output.\nfinal_cte as (\n    select\n        service_request_key,\n        created_date,\n        due_at,\n        completed_at,\n        on_time_indicator,\n        department,\n        request_type,\n        description,\n        request_type_code,\n        status_code,\n        intake_form,\n        actual_days_to_complete_working,\n        sla_fy_2019,\n        ispublic,\n        citydst,\n        publiclocation,\n        transmit_timestamp\n    from\n        cast_columns\n)\n\n-- Select all columns from the final_cte as the result of this model.\nselect * from final_cte", "relation_name": "`lumley-analytics`.`dbt_dev`.`base_src_chattadata_311_service_requests`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-10T17:49:31.280146Z", "completed_at": "2024-11-10T17:49:31.284805Z"}, {"name": "execute", "started_at": "2024-11-10T17:49:31.287344Z", "completed_at": "2024-11-10T17:49:31.287352Z"}], "thread_id": "Thread-4", "execution_time": 0.009214639663696289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.lumley_analytics.sn_src_chattadata_311_service_requests", "compiled": true, "compiled_code": " \n\n\n\nselect * from `lumley-analytics`.`dbt_dev`.`base_src_chattadata_311_service_requests`\n", "relation_name": "`lumley-analytics`.`snapshots`.`sn_src_chattadata_311_service_requests`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-10T17:49:31.292401Z", "completed_at": "2024-11-10T17:49:31.311714Z"}, {"name": "execute", "started_at": "2024-11-10T17:49:31.314214Z", "completed_at": "2024-11-10T17:49:31.314225Z"}], "thread_id": "Thread-1", "execution_time": 0.027653217315673828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.lumley_analytics.accepted_values_base_src_chattadata_311_service_requests_ispublic__yes__no.3b27e50410", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        ispublic as value_field,\n        count(*) as n_records\n\n    from `lumley-analytics`.`dbt_dev`.`base_src_chattadata_311_service_requests`\n    group by ispublic\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'yes','no'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-10T17:49:31.297393Z", "completed_at": "2024-11-10T17:49:31.313046Z"}, {"name": "execute", "started_at": "2024-11-10T17:49:31.319594Z", "completed_at": "2024-11-10T17:49:31.319606Z"}], "thread_id": "Thread-3", "execution_time": 0.03146171569824219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.lumley_analytics.accepted_values_base_src_chattadata_311_service_requests_on_time_indicator__Yes__No__N_A.bafc98a00b", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        on_time_indicator as value_field,\n        count(*) as n_records\n\n    from `lumley-analytics`.`dbt_dev`.`base_src_chattadata_311_service_requests`\n    group by on_time_indicator\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Yes','No','N/A'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-10T17:49:31.303617Z", "completed_at": "2024-11-10T17:49:31.313628Z"}, {"name": "execute", "started_at": "2024-11-10T17:49:31.320647Z", "completed_at": "2024-11-10T17:49:31.320654Z"}], "thread_id": "Thread-2", "execution_time": 0.03170609474182129, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.lumley_analytics.unique_base_src_chattadata_311_service_requests_service_request_key.4539d7e833", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select service_request_key as unique_field\n  from `lumley-analytics`.`dbt_dev`.`base_src_chattadata_311_service_requests`\n  where service_request_key is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-10T17:49:31.356233Z", "completed_at": "2024-11-10T17:49:31.374878Z"}, {"name": "execute", "started_at": "2024-11-10T17:49:31.376736Z", "completed_at": "2024-11-10T17:49:31.376748Z"}], "thread_id": "Thread-1", "execution_time": 0.024599075317382812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.lumley_analytics.accepted_values_sn_src_chattadata_311_service_requests_ispublic__yes__no.b765e6d3b8", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        ispublic as value_field,\n        count(*) as n_records\n\n    from `lumley-analytics`.`snapshots`.`sn_src_chattadata_311_service_requests`\n    group by ispublic\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'yes','no'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-10T17:49:31.361838Z", "completed_at": "2024-11-10T17:49:31.375502Z"}, {"name": "execute", "started_at": "2024-11-10T17:49:31.377704Z", "completed_at": "2024-11-10T17:49:31.377711Z"}], "thread_id": "Thread-3", "execution_time": 0.024776220321655273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.lumley_analytics.accepted_values_sn_src_chattadata_311_service_requests_on_time_indicator__Yes__No__N_A.65937e7e0f", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        on_time_indicator as value_field,\n        count(*) as n_records\n\n    from `lumley-analytics`.`snapshots`.`sn_src_chattadata_311_service_requests`\n    group by on_time_indicator\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Yes','No','N/A'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-10T17:49:31.367725Z", "completed_at": "2024-11-10T17:49:31.376154Z"}, {"name": "execute", "started_at": "2024-11-10T17:49:31.378588Z", "completed_at": "2024-11-10T17:49:31.378595Z"}], "thread_id": "Thread-2", "execution_time": 0.024986982345581055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.lumley_analytics.unique_sn_src_chattadata_311_service_requests_service_request_key.a9cd640958", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select service_request_key as unique_field\n  from `lumley-analytics`.`snapshots`.`sn_src_chattadata_311_service_requests`\n  where service_request_key is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-10T17:49:31.315139Z", "completed_at": "2024-11-10T17:49:31.584754Z"}, {"name": "execute", "started_at": "2024-11-10T17:49:31.585387Z", "completed_at": "2024-11-10T17:49:31.585400Z"}], "thread_id": "Thread-4", "execution_time": 0.27495455741882324, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.lumley_analytics.stg_chattadata_311_service_requests", "compiled": true, "compiled_code": "with source as (\n\n    select\n\n        `service_request_key`,\n  `created_date`,\n  `due_at`,\n  `completed_at`,\n  `on_time_indicator`,\n  `department`,\n  `request_type`,\n  `description`,\n  `request_type_code`,\n  `status_code`,\n  `intake_form`,\n  `actual_days_to_complete_working`,\n  `sla_fy_2019`,\n  `ispublic`,\n  `citydst`,\n  `publiclocation`,\n  `transmit_timestamp`,\n  `dbt_scd_id`,\n  `dbt_updated_at`,\n  `dbt_valid_from`,\n  `dbt_valid_to`\n\n    from\n\n        `lumley-analytics`.`snapshots`.`sn_src_chattadata_311_service_requests`\n\n    where\n\n        dbt_valid_to is null\n\n),\n\nrecast as (\n\n    select\n\n        service_request_key,\n        created_date,\n        due_at,\n        completed_at,\n        on_time_indicator,\n        department,\n        request_type,\n        description,\n        request_type_code,\n        status_code,\n        intake_form,\n        actual_days_to_complete_working,\n        sla_fy_2019,\n        ispublic,\n        citydst,\n        cast(\n            ST_GEOGPOINT(\n                CAST(JSON_EXTRACT_SCALAR(publiclocation, '$.coordinates[0]') AS FLOAT64),\n                CAST(JSON_EXTRACT_SCALAR(publiclocation, '$.coordinates[1]') AS FLOAT64)\n            )\n            as geography)\n            as publiclocation,\n        transmit_timestamp\n\n    from\n\n        source\n\n),\n\nfinal_cte as (\n\n    select\n\n        service_request_key,\n        created_date,\n        due_at,\n        completed_at,\n        on_time_indicator,\n        department,\n        request_type,\n        description,\n        request_type_code,\n        status_code,\n        intake_form,\n        actual_days_to_complete_working,\n        sla_fy_2019,\n        ispublic,\n        citydst,\n        publiclocation,\n        transmit_timestamp\n\n    from\n\n        recast\n\n)\n\nselect * from final_cte", "relation_name": "`lumley-analytics`.`dbt_dev`.`stg_chattadata_311_service_requests`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-10T17:49:31.592068Z", "completed_at": "2024-11-10T17:49:31.607474Z"}, {"name": "execute", "started_at": "2024-11-10T17:49:31.608339Z", "completed_at": "2024-11-10T17:49:31.608348Z"}], "thread_id": "Thread-1", "execution_time": 0.020250558853149414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.lumley_analytics.accepted_values_stg_chattadata_311_service_requests_ispublic__yes__no.a83d1921d7", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        ispublic as value_field,\n        count(*) as n_records\n\n    from `lumley-analytics`.`dbt_dev`.`stg_chattadata_311_service_requests`\n    group by ispublic\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'yes','no'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-10T17:49:31.598055Z", "completed_at": "2024-11-10T17:49:31.609428Z"}, {"name": "execute", "started_at": "2024-11-10T17:49:31.610627Z", "completed_at": "2024-11-10T17:49:31.610634Z"}], "thread_id": "Thread-3", "execution_time": 0.021244049072265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.lumley_analytics.accepted_values_stg_chattadata_311_service_requests_on_time_indicator__Yes__No__N_A.1266a6fbc2", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        on_time_indicator as value_field,\n        count(*) as n_records\n\n    from `lumley-analytics`.`dbt_dev`.`stg_chattadata_311_service_requests`\n    group by on_time_indicator\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Yes','No','N/A'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-10T17:49:31.602854Z", "completed_at": "2024-11-10T17:49:31.610057Z"}, {"name": "execute", "started_at": "2024-11-10T17:49:31.611515Z", "completed_at": "2024-11-10T17:49:31.611522Z"}], "thread_id": "Thread-2", "execution_time": 0.02079176902770996, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.lumley_analytics.unique_stg_chattadata_311_service_requests_service_request_key.dfe477b18a", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select service_request_key as unique_field\n  from `lumley-analytics`.`dbt_dev`.`stg_chattadata_311_service_requests`\n  where service_request_key is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 0.8864567279815674, "args": {"project_dir": "/home/runner/work/lumley_analytics/lumley_analytics", "source_freshness_run_project_hooks": false, "log_file_max_bytes": 10485760, "write_json": true, "partial_parse_file_diff": true, "compile": true, "exclude": [], "log_format": "default", "macro_debugging": false, "defer": false, "select": [], "strict_mode": false, "which": "generate", "profiles_dir": "/home/runner/work/lumley_analytics/lumley_analytics", "log_path": "/home/runner/work/lumley_analytics/lumley_analytics/logs", "partial_parse": true, "log_format_file": "debug", "vars": {}, "send_anonymous_usage_stats": true, "require_explicit_package_overrides_for_builtin_materializations": true, "favor_state": false, "use_colors": true, "print": true, "enable_legacy_logger": false, "cache_selected_only": false, "log_level": "info", "require_resource_names_without_spaces": false, "log_level_file": "debug", "empty_catalog": false, "introspect": true, "indirect_selection": "eager", "quiet": false, "invocation_command": "dbt docs generate", "populate_cache": true, "static": false, "static_parser": true, "use_colors_file": true, "warn_error_options": {"include": [], "exclude": []}, "printer_width": 80, "version_check": true, "show_resource_report": false}}